{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from 'axios';\n\n\nconst API_KEY = '38581937-9c20710af1d4a9eb0308799a1';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst spinner = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.loadMoreButton');\n\nshowLoadMore(false);\nshowLoadSpinner(false);\n\nlet selectedPicture = '';\nlet page = 1;\nlet limit = 40;\n\n\n\n\nform.addEventListener('submit', onFormSubmit);\n\nasync function onFormSubmit(ev) {\n    ev.preventDefault();\n    page = 1;\n    selectedPicture = ev.target.image.value;\n    changeLoaderPosition();\n    showLoadMore(false);\n    showLoadSpinner(true);\n    gallery.innerHTML = '';\n    ev.target.image.blur();\n    ev.target.image.value = '';\n    const images = await fetchImages(selectedPicture);\n    handleWithResponce(images);\n}\n\nasync function fetchImages(image) {\n    const searchParams = new URLSearchParams({\n        key: API_KEY,\n        image_type: \"photo\",\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 40,\n        page,\n    });\n\n    const response = await axios.get(`${BASE_URL}?${searchParams}&q=${image}`);\n    return response.data;\n}\n\nfunction handleWithResponce(images) {\n    showLoadMore(images.hits.length >= limit);\n\n    if (!images.hits.length) {\n        iziToast.warning({\n            position: 'topRight',\n            message: 'Sorry, there are no images matching your search query. Please try again!',\n        });\n        showLoadSpinner(false)\n        return\n    }\n\n    images.total < limit ? showIziToastMessage() : null;\n\n    if (page === 1) {\n        iziToast.success({\n            position: 'topRight',\n            message: `Congratulations! We found ${images.total} images`,\n            timeout: 2000,\n        });\n    }\n\n    showLoadSpinner(false);\n\n    renderGallery(images.hits);\n\n    const galleryLightBox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n    galleryLightBox.refresh();\n}\n\nloadMoreButton.addEventListener('click', onLoadMoreClick);\n\nasync function onLoadMoreClick() {\n    page += 1;\n    changeLoaderPosition();\n    showLoadSpinner(true);\n    showLoadMore(false);\n    const response = await fetchImages(selectedPicture);\n    const totalPages = Math.ceil(response.total / limit);\n    page >= totalPages ? (showIziToastMessage()) : null\n    handleWithResponce(response);\n    smoothScroll();\n}\n\nfunction renderGallery(images) {\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, comments, downloads, views }) => `<li class='gallery-item'>\n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        <div class=\"gallery-description\">\n      <span class='gallery-span'>\n        <div class=\"upper-text\">Likes</div>\n        <div class=\"lower-text\">${likes}</div>\n      </span>\n      <span class='gallery-span'>\n        <div class=\"upper-text\">Views</div>\n        <div class=\"lower-text\">${views}</div>\n      </span>\n      <span class='gallery-span'>\n        <div class=\"upper-text\">Comments</div>\n        <div class=\"lower-text\">${comments}</div>\n      </span>\n      <span class='gallery-span'>\n        <div class=\"upper-text\">Downloads</div>\n        <div class=\"lower-text\">${downloads}</div>\n      </span>\n      </div>\n        </a>\n</li>`).join('');\n    gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction showLoadSpinner(should) {\n    spinner.style.display = should ? 'block' : 'none';\n}\n\nfunction showLoadMore(should) {\n    loadMoreButton.style.display = should ? 'block' : 'none'\n}\n\nfunction showIziToastMessage() {\n    iziToast.error({\n        position: \"topRight\",\n        message: \"We're sorry, there are no more posts to load\"\n    })\n}\n\n\n\nfunction smoothScroll() {\n    const cart = document.querySelector('.gallery-item');\n    let heightOfOneCart = cart.getBoundingClientRect().height;\n    window.scrollBy({ top: heightOfOneCart * 2, behavior: \"smooth\" })\n}\n\nfunction changeLoaderPosition() {\n    page === 1 ? (spinner.style.top = \"40%\",\n        spinner.style.left = '50%') : (spinner.style.top = '85%', spinner.style.left = '47%')\n}\n\n\n\n\n\n"],"names":["API_KEY","BASE_URL","form","gallery","spinner","loadMoreButton","showLoadMore","showLoadSpinner","selectedPicture","page","limit","onFormSubmit","ev","changeLoaderPosition","images","fetchImages","handleWithResponce","image","searchParams","axios","iziToast","showIziToastMessage","renderGallery","SimpleLightbox","onLoadMoreClick","response","totalPages","smoothScroll","markup","webformatURL","largeImageURL","tags","likes","comments","downloads","views","should","heightOfOneCart"],"mappings":"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"}